import{r as t}from"./index.03be2d59.js";import{L as k,E as c,g as b}from"./error.d41e34a3.js";import{o as y,s as v,u as w,F as E,S as N,t as T,m as I}from"./success.195e3d70.js";import{S as L}from"./social.1e493d13.js";import{j as e}from"./jsx-runtime.b9e88e07.js";const R="There was a problem loading your slack config.",A=y({token:v()}),_=()=>{const[i,u]=t.useState(!0),[a,m]=t.useState(""),[o,d]=t.useState(""),[r,n]=t.useState(!1),{register:f,handleSubmit:x,reset:p,formState:{errors:g,isSubmitting:l}}=w({reValidateMode:"onBlur",resolver:T(A),defaultValues:{token:""}}),j=async()=>{try{const s=await b("/v1/slack");p({token:s?.values?.token})}catch{m(R)}u(!1)},S=async s=>{try{await I({method:"POST",apiPath:"/v1/slack",body:s}),n(!0)}catch(h){d(h.toString())}};return t.useEffect(()=>{j()},[]),t.useEffect(()=>{if(r){const s=setTimeout(()=>{n(!1),clearTimeout(s)},4e3)}},[r]),i?e.jsx(k,{}):a?e.jsx(c,{error:a}):e.jsxs("div",{className:"max-w-[1440px]",children:[e.jsxs("div",{className:"flex flex-row justify-start align-middle pb-4 mb-4 font-bold text-lg leading-5 border-b",children:[e.jsx(L,{className:"mr-2 w-[20px]"}),e.jsx("span",{className:"text-web",children:"Slack Integration"})]}),e.jsx("div",{children:e.jsxs("h1",{className:"mb-6",children:["In order to get Slack Alerts, you'll need to provide a Slack API token. To generate a token, follow the instructions"," ",e.jsx("a",{href:"https://api.slack.com/tutorials/tracks/getting-a-token",target:"_new",className:"underline underline-offset-2",children:"here"}),"."]})}),o?e.jsx(c,{error:o}):null,e.jsxs("form",{onSubmit:x(S),className:"max-w-lg",children:[e.jsx(E,{name:"token",label:"Slack Token",register:f,error:g.token?.message||""}),e.jsxs("div",{className:"flex flex-row justify-start align-middle",children:[e.jsx("input",{type:"submit",disabled:l,className:`flex justify-center btn-heimdal mr-4 ${l?"cursor-not-allowed":"cursor-pointer"}`,value:"Save"}),e.jsx("a",{href:"/",children:e.jsx("input",{type:"button",className:"flex justify-center btn-secondary cursor-pointer",value:"Cancel"})}),r?e.jsx(N,{}):null]})]})]})};export{_ as SlackIntegration};
